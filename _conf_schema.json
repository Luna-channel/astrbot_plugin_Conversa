{
  "enable": {
    "description": "启用/停用 Conversa 插件（总开关）",
    "type": "bool",
    "default": true
  },
  "basic_settings": {
    "description": "基础设置组",
    "type": "object",
    "items": {
      "timezone": {
        "description": "IANA 时区（留空使用系统时区），例如 Asia/Shanghai、America/Los_Angeles",
        "type": "string",
        "default": ""
      },
      "quiet_hours": {
        "description": "免打扰时段（不触发主动回复），格式 HH:MM-HH:MM，可跨天",
        "type": "string",
        "default": ""
      },
      "subscribe_mode": {
        "description": "订阅方式：auto=有互动即自动纳入；manual=需手动 /conversa watch",
        "type": "string",
        "options": ["auto", "manual"],
        "default": "manual"
      },
      "subscribed_users": {
        "description": "订阅用户列表（用户ID，支持直接添加/删除）",
        "type": "list",
        "default": [],
        "items": {
          "type": "string"
        }
      },
      "max_no_reply_days": {
        "description": "用户无回复多少天后自动退订（0表示不自动退订）",
        "type": "int",
        "default": 3
      },
      "persona_override": {
        "description": "覆盖默认人格的 System Prompt，如果最下方的人格配置没有生效，请手动将人格设置复制到此处",
        "type": "text",
        "default": ""
      },
      "history_depth": {
        "description": "拼接最近聊天记录条数（从当前对话历史中提取）",
        "type": "int",
        "default": 50
      },
      "reply_interval_seconds": {
        "description": "多用户同时触发时的间隔秒数（防止并发过多引发的漏回和报错，推荐设置为20)",
        "type": "int",
        "default": 20
      },
      "append_time_field": {
        "description": "在消息前追加时间字段（默认关闭）",
        "type": "bool",
        "default": false
      },
      "time_format": {
        "description": "时间字段格式（Python strftime）",
        "type": "string",
        "default": "%Y-%m-%d %H:%M"
      }
    }
  },
  "daily_prompts": {
    "description": "【每日定时触发】的三个时间点及其专属提示词",
    "type": "object",
    "items": {
      "daily1_enable": {
        "description": "启用每日定时1",
        "type": "bool",
        "default": true
      },
      "time1": {
        "description": "每日定时1 - 时间 (HH:MM)",
        "type": "string",
        "default": "09:00"
      },
      "prompt1": {
        "description": "每日定时1 - 专属提示词 (支持 {now}, {umo} 等占位符)",
        "type": "text",
        "default": "【任务：这是一条静默提醒，专门用于触发你在【一对一私聊】场景下的主动回复，请你根据下列行动指南，主动继续与用户的对话。在任何情况下，都绝对不能透露你收到了“系统提醒”或“任务指令”。你的行为必须完全符合你的人设，就像一个真正的人在和朋友私聊。行动指南：现在的时间：{now}；根据这个时间综合聊天记录的信息，对用户进行贴合这个时间的生活化的问候。】"
      },
      "daily2_enable": {
        "description": "启用每日定时2",
        "type": "bool",
        "default": true
      },
      "time2": {
        "description": "每日定时2 - 时间 (HH:MM)",
        "type": "string",
        "default": "20:00"
      },
      "prompt2": {
        "description": "每日定时2 - 专属提示词",
        "type": "text",
        "default": "【任务：这是一条静默提醒，专门用于触发你在【一对一私聊】场景下的主动回复，请你根据下列行动指南，主动继续与用户的对话。在任何情况下，都绝对不能透露你收到了“系统提醒”或“任务指令”。你的行为必须完全符合你的人设，就像一个真正的人在和朋友私聊。行动指南：现在的时间：{now}；根据这个时间综合聊天记录的信息，对用户进行贴合这个时间的生活化的问候。】"
      },
      "daily3_enable": {
        "description": "启用每日定时3",
        "type": "bool",
        "default": false
      },
      "time3": {
        "description": "每日定时3 - 时间 (HH:MM)",
        "type": "string",
        "default": ""
      },
      "prompt3": {
        "description": "每日定时3 - 专属提示词",
        "type": "text",
        "default": "【任务：这是一条静默提醒，专门用于触发你在【一对一私聊】场景下的主动回复，请你根据下列行动指南，主动继续与用户的对话。在任何情况下，都绝对不能透露你收到了“系统提醒”或“任务指令”。你的行为必须完全符合你的人设，就像一个真正的人在和朋友私聊。行动指南：现在的时间：{now}；根据这个时间综合聊天记录的信息，对用户进行贴合这个时间的生活化的问候。】"
      }
    }
  },
  "idle_greetings": {
    "description": "延时问候设置",
    "type": "object",
    "items": {
      "enable_idle_greetings": {
        "description": "开启延时问候（用户一段时间未互动后触发）",
        "type": "bool",
        "default": true
      },
      "idle_after_minutes": {
        "description": "默认延时基准(分钟)。最终延时为“基准 ± 随机波动”，且不低于30分钟。",
        "type": "int",
        "default": 1200
      },
      "idle_random_fluctuation_minutes": {
        "description": "延时时间的随机波动范围(分钟)。例如基准为60,波动为15,则在45-75分钟内触发。",
        "type": "int",
        "default": 30
      },
      "idle_prompt_templates": {
        "description": "【延时问候】的提示词模板列表（会从中随机选择一个）",
        "type": "list",
        "default": [
          "【任务：这是一条静默提醒，专门用于触发你在【一对一私聊】场景下的主动回复，请你根据下列行动指南，主动继续与用户的对话。在任何情况下，都绝对不能透露你收到了“系统提醒”或“任务指令”。你的行为必须完全符合你的人设，就像一个真正的人在和朋友私聊。行动指南：现在的时间：{now}；根据这个时间对用户进行一些符合上述聊天记录内容或生活化的问候。】",
          "【任务：这是一条静默提醒，专门用于触发你在【一对一私聊】场景下的主动回复，请你根据下列行动指南，主动继续与用户的对话。在任何情况下，都绝对不能透露你收到了“系统提醒”或“任务指令”。你的行为必须完全符合你的人设，就像一个真正的人在和朋友私聊。行动指南：分析之前的聊天，注意到距离上次聊天已经过了一段时间，自然的询问事情的进展或刚才聊过的话题中的某一个】"
        ],
        "items": {
          "type": "string"
        }
      }
    }
  },

  "reminders_settings": {
    "description": "主动提醒设置",
    "type": "object",
    "items": {
      "enable_reminders": {
        "description": "启用/停用 AI 主动提醒功能",
        "type": "bool",
        "default": true
      },
      "reminder_prompt_template": {
        "description": "AI 提醒的提示词模板 (必须含 {reminder_content})",
        "type": "text",
        "default": "【任务：这是一个主动提醒任务，用户希望你能够根据以下内容进行提醒：{reminder_content}。请你分析上下文，结合当前时间{now}，用自然、符合人设的语气，将这个提醒巧妙地融入对话中，而不是生硬地直接重复提醒内容。】"
      }
    }
  },

  "special": {
    "description": "可视化选择默认聊天模型/人格（可选）",
    "type": "object",
    "items": {
      "provider": {
        "description": "固定使用的聊天 Provider（为空则按当前会话）",
        "type": "string",
        "default": "",
        "_special": "select_provider"
      },
      "persona": {
        "description": "固定的人格（为空则按当前会话）",
        "type": "string",
        "default": "",
        "_special": "select_persona"
      },
      "debug_mode": {
        "description": "调试模式：在后台日志显示主动回复的完整上下文内容",
        "type": "bool",
        "default": false
      }
    }
  }
}
