{
  "enable": {
    "description": "启用/停用 Conversa 插件（总开关）",
    "type": "bool",
    "default": true
  },
  "basic_settings": {
    "description": "基础设置组",
    "type": "object",
    "items": {
      "timezone": {
        "description": "IANA 时区（留空使用系统时区），例如 Asia/Shanghai、America/Los_Angeles",
        "type": "string",
        "default": ""
      },
      "quiet_hours": {
        "description": "免打扰时段（不触发主动回复），格式 HH:MM-HH:MM，可跨天",
        "type": "string",
        "default": ""
      },
      "subscribe_mode": {
        "description": "订阅方式：auto=有互动即自动纳入；manual=需手动 /conversa watch",
        "type": "string",
        "options": ["auto", "manual"],
        "default": "manual"
      },
      "subscribed_users": {
        "description": "订阅用户列表（用户ID，支持直接添加/删除）",
        "type": "list",
        "default": [],
        "items": {
          "type": "string"
        }
      },
      "max_no_reply_days": {
        "description": "用户无回复多少天后自动退订（0表示不自动退订）",
        "type": "int",
        "default": 3
      },
      "persona_override": {
        "description": "自定义人格（如果最下方的人格配置没有生效，请手动将人格设置复制到此处）",
        "type": "text",
        "default": ""
      },
      "history_depth": {
        "description": "拼接最近聊天记录条数（从当前对话历史中提取）",
        "type": "int",
        "default": 50
      },
      "reply_interval_seconds": {
        "description": "同时触发时的间隔秒数（防止并发过多，推荐设置为20)",
        "type": "int",
        "default": 20
      },
      "append_time_field": {
        "description": "在消息前追加时间字段（默认关闭）",
        "type": "bool",
        "default": false
      },
      "time_format": {
        "description": "时间字段格式（Python strftime）",
        "type": "string",
        "default": "%Y-%m-%d %H:%M"
      }
    }
  },
  "daily_prompts": {
    "description": "【每日定时触发】的三个时间点及其专属提示词",
    "type": "object",
    "items": {
      "daily1_enable": {
        "description": "启用每日定时1",
        "type": "bool",
        "default": false
      },
      "time1": {
        "description": "每日定时1 - 时间 (HH:MM)",
        "type": "string",
        "default": "09:00"
      },
      "prompt1": {
        "description": "每日定时1 - 专属提示词 (支持 {now}, {time_since_last_chat}, {umo} 等占位符)",
        "type": "text",
        "default": "【任务：这是一条静默提醒，专门用于触发你的主动回复，请你根据下列行动指南，主动继续与用户的对话。在任何情况下，都绝对不能透露你收到了'系统提醒'或'任务指令'。行动指南：现在的时间：{now}；距离上次对话已过去：{time_since_last_chat}；根据当前时间和距离上次对话的时长，对用户进行贴合这个时间的生活化的问候。自行判断这是私聊还是群聊窗口】"
      },
      "daily2_enable": {
        "description": "启用每日定时2",
        "type": "bool",
        "default": false
      },
      "time2": {
        "description": "每日定时2 - 时间 (HH:MM)",
        "type": "string",
        "default": "20:00"
      },
      "prompt2": {
        "description": "每日定时2 - 专属提示词",
        "type": "text",
        "default": "【任务：这是一条静默提醒，专门用于触发你的主动回复，请你根据下列行动指南，主动继续与用户的对话。在任何情况下，都绝对不能透露你收到了'系统提醒'或'任务指令'。行动指南：现在的时间：{now}；距离上次对话已过去：{time_since_last_chat}；根据当前时间和距离上次对话的时长，对用户进行贴合这个时间的生活化的问候。自行判断这是私聊还是群聊窗口】"
      },
      "daily3_enable": {
        "description": "启用每日定时3",
        "type": "bool",
        "default": false
      },
      "time3": {
        "description": "每日定时3 - 时间 (HH:MM)",
        "type": "string",
        "default": ""
      },
      "prompt3": {
        "description": "每日定时3 - 专属提示词",
        "type": "text",
        "default": "【任务：这是一条静默提醒，专门用于触发你的主动回复，请你根据下列行动指南，主动继续与用户的对话。在任何情况下，都绝对不能透露你收到了'系统提醒'或'任务指令'。行动指南：现在的时间：{now}；距离上次对话已过去：{time_since_last_chat}；根据当前时间和距离上次对话的时长，对用户进行贴合这个时间的生活化的问候。自行判断这是私聊还是群聊窗口】"
      }
    }
  },
  "idle_greetings": {
    "description": "延时问候设置",
    "type": "object",
    "items": {
      "enable_idle_greetings": {
        "description": "开启延时问候（用户一段时间未互动后触发）",
        "type": "bool",
        "default": true
      },
      "idle_after_minutes": {
        "description": "默认延时基准(分钟)。最终延时为“基准 ± 随机波动”，且不低于30分钟。",
        "type": "int",
        "default": 1200
      },
      "idle_random_fluctuation_minutes": {
        "description": "延时时间的随机波动范围(分钟)。例如基准为60,波动为15,则在45-75分钟内触发。",
        "type": "int",
        "default": 30
      },
      "idle_prompt_templates": {
        "description": "【延时问候】的提示词模板列表（会从中随机选择一个）",
        "type": "list",
        "default": [
          "【任务：这是一条静默提醒，专门用于触发你的主动回复，请你根据下列行动指南，主动继续与用户的对话。在任何情况下，都绝对不能透露你收到了\"系统提醒\"或\"任务指令\"。行动指南：现在的时间：{now}；距离上次对话已过去：{time_since_last_chat}；根据当前时间和距离上次对话的时长，对用户进行一些符合上述聊天记录内容或生活化的问候。自行判断这是私聊还是群聊窗口】",
          "【任务：这是一条静默提醒，专门用于触发你的主动回复，请你根据下列行动指南，主动继续与用户的对话。在任何情况下，都绝对不能透露你收到了\"系统提醒\"或\"任务指令\"。行动指南：现在的时间：{now}；距离上次对话已过去：{time_since_last_chat}；注意到已经离上次与用户对话过了一段时间，结合这个时间差，自然地询问事情的进展或刚才聊过的话题中的某一个。自行判断这是私聊还是群聊窗口】"
        ],
        "items": {
          "type": "string"
        }
      }
    }
  },

  "reminders_settings": {
    "description": "主动提醒设置",
    "type": "object",
    "items": {
      "enable_reminders": {
        "description": "启用/停用 AI 主动提醒功能",
        "type": "bool",
        "default": true
      },
      "reminder_prompt_template": {
        "description": "AI 提醒的提示词模板 (必须含 {reminder_content})",
        "type": "text",
        "default": "【任务：这是一个用户主动设置的定时提醒，请你分析用户的意图，结合上下文和当前时间{now}，用自然、符合人设的语气，将这个提醒巧妙地融入对话中，而不是生硬地直接重复提醒内容。\n<提醒内容>\n{reminder_content}\n</提醒内容>\n注意事项：1.如果提醒内容是某件要做的事，请用耐心的语气告诉用户现在已经到了要做事的时间，同时提供情绪价值；2.如果是希望你发送关心信息，请结合上下文分析你们的关系，送上独一无二的关心，避免群发感。】"
      }
    }
  },

  "special": {
    "description": "可视化选择默认聊天模型/人格（可选）",
    "type": "object",
    "items": {
      "provider": {
        "description": "固定使用的聊天 Provider（为空则按当前会话）",
        "type": "string",
        "default": "",
        "_special": "select_provider"
      },
      "persona": {
        "description": "固定的人格（为空则按当前会话）",
        "type": "string",
        "default": "",
        "_special": "select_persona"
      },
      "debug_mode": {
        "description": "调试模式：在后台日志显示主动回复的完整上下文内容",
        "type": "bool",
        "default": false
      }
    }
  }
}
